---
title: "Result_interpretation_1"
output: html_document
---

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
library(ggplot2)
library(dplyr)
```

Join GAMA-generated csv file into one data.frame. 

```{r}
replications <- 4
variations <- 324

p1<-ggplot()+ggtitle("Emotional state") + labs(x="ticks [10 min]",y="Emotional state [-]",size=(200))
p2<-ggplot()+ggtitle("Unsatisfied consumption") + labs(x="ticks [10 min]",y="Unsatisfied consumption [kg]",size=(200))
p3<-ggplot()+ggtitle("Distribution size") + labs(x="ticks [10 min]",y="Average distribution size [kg]",size=(200))
p4<-ggplot()+ggtitle("Queuing time") + labs(x="ticks [10 min]",y="Total queuing time [min]",size=(200))



input_df <- NULL
ql_df<-NULL
sum_fd_df<-NULL
sum_uc_df<-NULL
avg_es_df<-NULL

for (var in 0:(variations-1)) {
    message(var)
    for (rep in 0:(replications-1)){
      message(rep)
      ql_str <- paste0("/home/daan/GAMA/workspace/results/uncap_2k/outcomes_ql_sim",var,"_rep",rep,".csv")
      input_str <-  paste0("/home/daan/GAMA/workspace/results/uncap_2k/outcomes_input_sim",var,"_rep",rep,".csv")
      avg_es_str <- paste0("/home/daan/GAMA/workspace/results/uncap_2k/outcomes_avg_es_sim",var,"_rep",rep,".csv")
      sum_fd_str <- paste0("/home/daan/GAMA/workspace/results/uncap_2k/outcomes_sum_fd_sim",var,"_rep",rep,".csv")
      sum_uc_str <- paste0("/home/daan/GAMA/workspace/results/uncap_2k/outcomes_sum_uc_sim",var,"_rep",rep,".csv")
      
      ql_input<-read.csv(ql_str,skip=1,header = FALSE)
      input_input<-read.csv(input_str,skip=1,header = FALSE)
      avg_es_input<-read.csv(avg_es_str,skip=1,header = FALSE)
      sum_fd_input<-read.csv(sum_fd_str,skip=1,header = FALSE)
      sum_uc_input<-read.csv(sum_uc_str,skip=1,header = FALSE)

      if (is.null(input_df)){
        input_df <- input_input[,3:ncol(input_input)]
        ql_df <- ql_input[,2:ncol(ql_input)]
        sum_fd_df <- sum_fd_input[,3:ncol(sum_fd_input)]
        sum_uc_df <- sum_uc_input[,3:ncol(sum_uc_input)]
        avg_es_df <- avg_es_input[,3:ncol(avg_es_input)]
      } else {
        input_df <- rbind(input_df,input_input[,3:ncol(input_input)])
        ql_df <- rbind(ql_df,ql_input[,2:ncol(ql_input)])
        sum_fd_df <- rbind(sum_fd_df,sum_fd_input[,3:ncol(sum_fd_input)])
        sum_uc_df <- rbind(sum_uc_df,sum_uc_input[,3:ncol(sum_uc_input)])
        avg_es_df <- rbind(avg_es_df,avg_es_input[,3:ncol(avg_es_input)])
      }

      
    }
}

write.csv(input_df,"/home/daan/Desktop/input.csv")
write.csv(ql_df,"/home/daan/Desktop/ql.csv")
write.csv(sum_fd_df,"/home/daan/Desktop/sum_fd.csv")
write.csv(sum_uc_df,"/home/daan/Desktop/sum_uc.csv")
write.csv(avg_es_df,"/home/daan/Desktop/avg_es.csv")
```

In case already done, read from csv:

```{r}
input_df <- read.csv("/home/daan/Desktop/Uncapacitated/input.csv")
ql_df <- read.csv("/home/daan/Desktop/Uncapacitated/ql.csv")
sum_fd_df <- read.csv("/home/daan/Desktop/Uncapacitated/sum_fd.csv")
sum_uc_df <- read.csv("/home/daan/Desktop/Uncapacitated/sum_uc.csv")
avg_es_df <- read.csv("/home/daan/Desktop/Uncapacitated/avg_es.csv")
```


Initialise plots:
```{r}
p1<-ggplot()+ggtitle("Average emotional state, all samples, day 1-30") + labs(x="ticks [10 min]",y="Emotional state [-]",size=(200))
p2<-ggplot()+ggtitle("Unsatisfied consumption, all samples, day 1-30") + labs(x="ticks [10 min]",y="Unsatisfied consumption [kg]",size=(200))
p3<-ggplot()+ggtitle("Food degradation, all samples, day 1-30") + labs(x="ticks [10 min]",y="Food subject to degradation [kg]",size=(200))

avg_es_df <- avg_es_df[,2:ncol(avg_es_df)]
sum_fd_df <- sum_fd_df[,2:ncol(avg_es_df)]
sum_uc_df <- sum_uc_df[,2:ncol(avg_es_df)]


for (entry in 1:(nrow(avg_es_df)/4)){ # For every fourth replication
  p1<-p1+geom_line(aes_string(x=1:ncol(avg_es_df),y=as.numeric(avg_es_df[entry*4,])))
  p2<-p2+geom_line(aes_string(x=1:ncol(sum_fd_df),y=t(sum_fd_df)[,entry*4]))
  p3<-p3+geom_line(aes_string(x=1:ncol(sum_uc_df),y=t(sum_uc_df)[,entry*4]))
}
```

Plot for the emotional states
```{r}
print(p1)
```

Plot with Unsatisfied consumption
```{r}
print(p2)
```

Plot with food subject to degradation
```{r}
print(p3)
```

```{r}

fac_nb <- 1

p4<-ggplot()+ggtitle(paste0("Queue length, all samples, day 1-30, facility ",fac_nb)) + labs(x="ticks [10 min]",y="# People queuing [-]",size=(200))

f4 <- filter(ql_df, X%%48==fac_nb)
f4 <- f4[,3:ncol(f4)]

for (entry in 1:(nrow(f4)/2)){
  tmp <- as.numeric(f4[entry,])
  p4<-p4+geom_line(aes_string(x=1:(length(tmp)),y=tmp))
  
}
print(p4)
```

```{r}

fac_nb <- 2

p4<-ggplot()+ggtitle(paste0("Queue length, all samples, day 1-30, facility ",fac_nb)) + labs(x="ticks [10 min]",y="# People queuing [-]",size=(200))

f4 <- filter(ql_df, X%%48==fac_nb)
f4 <- f4[,3:ncol(f4)]

for (entry in 1:(nrow(f4)/2)){
  tmp <- as.numeric(f4[entry,])
  p4<-p4+geom_line(aes_string(x=1:(length(tmp)),y=tmp))
  
}
print(p4)
```


```{r}

fac_nb <- 3

p4<-ggplot()+ggtitle(paste0("Queue length, all samples, day 1-30, facility ",fac_nb)) + labs(x="ticks [10 min]",y="# People queuing [-]",size=(200))

f4 <- filter(ql_df, X%%48==fac_nb)
f4 <- f4[,3:ncol(f4)]

for (entry in 1:(nrow(f4)/2)){
  tmp <- as.numeric(f4[entry,])
  p4<-p4+geom_line(aes_string(x=1:(length(tmp)),y=tmp))
  
}
print(p4)
```


```{r}

fac_nb <- 4

p4<-ggplot()+ggtitle(paste0("Queue length, all samples, day 1-30, facility ",fac_nb)) + labs(x="ticks [10 min]",y="# People queuing [-]",size=(200))

f4 <- filter(ql_df, X%%48==fac_nb)
f4 <- f4[,3:ncol(f4)]

for (entry in 1:(nrow(f4)/2)){
  tmp <- as.numeric(f4[entry,])
  p4<-p4+geom_line(aes_string(x=1:(length(tmp)),y=tmp))
  
}
print(p4)
```


```{r}

fac_nb <- 5

p4<-ggplot()+ggtitle(paste0("Queue length, all samples, day 1-30, facility ",fac_nb)) + labs(x="ticks [10 min]",y="# People queuing [-]",size=(200))

f4 <- filter(ql_df, X%%48==fac_nb)
f4 <- f4[,3:ncol(f4)]

for (entry in 1:(nrow(f4)/2)){
  tmp <- as.numeric(f4[entry,])
  p4<-p4+geom_line(aes_string(x=1:(length(tmp)),y=tmp))
  
}
print(p4)
```


```{r}

fac_nb <- 6

p4<-ggplot()+ggtitle(paste0("Queue length, all samples, day 1-30, facility ",fac_nb)) + labs(x="ticks [10 min]",y="# People queuing [-]",size=(200))

f4 <- filter(ql_df, X%%48==fac_nb)
f4 <- f4[,3:ncol(f4)]

for (entry in 1:(nrow(f4)/2)){
  tmp <- as.numeric(f4[entry,])
  p4<-p4+geom_line(aes_string(x=1:(length(tmp)),y=tmp))
  
}
print(p4)
```























